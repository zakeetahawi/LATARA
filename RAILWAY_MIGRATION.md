# نقل البيانات إلى قاعدة بيانات Railway

هذا الملف يشرح كيفية نقل البيانات من قاعدة البيانات المحلية إلى قاعدة بيانات جديدة على Railway.

## الخطوات

### 1. إنشاء قاعدة بيانات PostgreSQL جديدة على Railway

1. قم بتسجيل الدخول إلى حساب Railway الخاص بك على [railway.app](https://railway.app/)
2. انقر على زر "New Project" (مشروع جديد)
3. اختر "Database" (قاعدة بيانات) ثم اختر "PostgreSQL"
4. انتظر حتى يتم إنشاء قاعدة البيانات
5. بعد إنشاء قاعدة البيانات، انقر عليها للحصول على بيانات الاتصال:
   - `DATABASE_URL`: رابط الاتصال الكامل
   - `PGUSER`: اسم المستخدم (عادة "postgres")
   - `PGPASSWORD`: كلمة المرور
   - `PGHOST`: اسم المضيف
   - `PGPORT`: رقم المنفذ (عادة 5432)
   - `PGDATABASE`: اسم قاعدة البيانات (عادة "railway")

### 2. استخدام سكريبت النقل

بعد الحصول على بيانات الاتصال، قم بتشغيل السكريبت التالي:

```bash
python migrate_to_railway.py --db-url "postgresql://postgres:password@containers-us-west-1.railway.app:5432/railway" --db-user "postgres" --db-password "password" --db-host "containers-us-west-1.railway.app" --db-port "5432" --db-name "railway"
```

استبدل القيم بالقيم الفعلية التي حصلت عليها من Railway.

### 3. ما يقوم به السكريبت

1. إنشاء نسخة احتياطية من قاعدة البيانات المحلية
2. تحديث ملف `.env` بمعلومات قاعدة البيانات الجديدة
3. اختبار الاتصال بقاعدة البيانات الجديدة
4. استعادة النسخة الاحتياطية في قاعدة البيانات الجديدة

### 4. التحقق من النتائج

بعد اكتمال عملية النقل، يمكنك التحقق من النتائج عن طريق:

1. تشغيل الخادم المحلي:
   ```bash
   python manage.py runserver
   ```

2. الوصول إلى التطبيق على `http://localhost:8000` والتحقق من أن البيانات موجودة

### 5. تحديث مشروع Railway

بعد التأكد من أن كل شيء يعمل بشكل صحيح، قم بتحديث مشروع Railway:

1. قم بإضافة التغييرات إلى Git:
   ```bash
   git add .
   git commit -m "تحديث إعدادات قاعدة البيانات لاستخدام قاعدة بيانات Railway"
   git push
   ```

2. انتظر حتى يتم نشر التطبيق على Railway

## استكشاف الأخطاء وإصلاحها

إذا واجهت أي مشاكل أثناء عملية النقل، فيمكنك:

1. التحقق من سجلات الأخطاء في الطرفية
2. التأكد من صحة بيانات الاتصال بقاعدة البيانات
3. التحقق من أن قاعدة البيانات الجديدة فارغة وجاهزة للاستخدام
4. التأكد من أن لديك الصلاحيات اللازمة للوصول إلى قاعدة البيانات

## العودة إلى قاعدة البيانات المحلية

إذا كنت بحاجة إلى العودة إلى قاعدة البيانات المحلية، فقم بتعديل ملف `.env` لاستخدام بيانات الاتصال المحلية:

```
DB_NAME=crm_system
DB_USER=crm_user
DB_PASSWORD=5525
DB_HOST=localhost
DB_PORT=5432
```

ثم قم بإعادة تشغيل الخادم المحلي.
